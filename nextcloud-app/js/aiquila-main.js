(function(){"use strict";const De=(e,t,n)=>{const r=Object.assign({escape:!0},{}),s=function(o,i){return i=i||{},o.replace(/{([^{}]*)}/g,function(l,u){const c=i[u];return r.escape?encodeURIComponent(typeof c=="string"||typeof c=="number"?c.toString():l):typeof c=="string"||typeof c=="number"?c.toString():l})};return e.charAt(0)!=="/"&&(e="/"+e),s(e,{})},H=(e,t,n)=>{const r=Object.assign({noRewrite:!1},{}),s=Kt();return window?.OC?.config?.modRewriteWorking===!0&&!r.noRewrite?s+De(e):s+"/index.php"+De(e)};function Kt(){let e=window._oc_webroot;if(typeof e>"u"){e=location.pathname;const t=e.indexOf("/index.php/");if(t!==-1)e=e.slice(0,t);else{const n=e.indexOf("/",1);e=e.slice(0,n>0?n:void 0)}}return e}function Jt(e,t,n){const r=`#initial-state-${e}-${t}`;if(window._nc_initial_state?.has(r))return window._nc_initial_state.get(r);window._nc_initial_state||(window._nc_initial_state=new Map);const s=document.querySelector(r);if(s===null)throw new Error(`Could not find initial state ${t} of ${e}`);try{const o=JSON.parse(atob(s.value));return window._nc_initial_state.set(r,o),o}catch(o){throw console.error("[@nextcloud/initial-state] Could not parse initial state",{key:t,app:e,error:o}),new Error(`Could not parse initial state ${t} of ${e}`,{cause:o})}}function Be(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ee,Me;function je(){if(Me)return Ee;Me=1;var e={};return Ee=typeof process=="object"&&e&&e.NODE_DEBUG&&/\bsemver\b/i.test(e.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{},Ee}var me,qe;function He(){if(qe)return me;qe=1;const e="2.0.0",t=256,n=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,s=t-6;return me={MAX_LENGTH:t,MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:s,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},me}var ee={exports:{}},Ge;function Wt(){return Ge||(Ge=1,(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:s}=He(),o=je();t=e.exports={};const i=t.re=[],l=t.safeRe=[],u=t.src=[],c=t.safeSrc=[],a=t.t={};let p=0;const m="[a-zA-Z0-9-]",b=[["\\s",1],["\\d",s],[m,r]],h=E=>{for(const[y,S]of b)E=E.split(`${y}*`).join(`${y}{0,${S}}`).split(`${y}+`).join(`${y}{1,${S}}`);return E},f=(E,y,S)=>{const R=h(y),w=p++;o(E,w,y),a[E]=w,u[w]=y,c[w]=R,i[w]=new RegExp(y,S?"g":void 0),l[w]=new RegExp(R,S?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${m}*`),f("MAINVERSION",`(${u[a.NUMERICIDENTIFIER]})\\.(${u[a.NUMERICIDENTIFIER]})\\.(${u[a.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${u[a.NUMERICIDENTIFIERLOOSE]})\\.(${u[a.NUMERICIDENTIFIERLOOSE]})\\.(${u[a.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${u[a.NONNUMERICIDENTIFIER]}|${u[a.NUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${u[a.NONNUMERICIDENTIFIER]}|${u[a.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASE",`(?:-(${u[a.PRERELEASEIDENTIFIER]}(?:\\.${u[a.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${u[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[a.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${m}+`),f("BUILD",`(?:\\+(${u[a.BUILDIDENTIFIER]}(?:\\.${u[a.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${u[a.MAINVERSION]}${u[a.PRERELEASE]}?${u[a.BUILD]}?`),f("FULL",`^${u[a.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${u[a.MAINVERSIONLOOSE]}${u[a.PRERELEASELOOSE]}?${u[a.BUILD]}?`),f("LOOSE",`^${u[a.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${u[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${u[a.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${u[a.XRANGEIDENTIFIER]})(?:\\.(${u[a.XRANGEIDENTIFIER]})(?:\\.(${u[a.XRANGEIDENTIFIER]})(?:${u[a.PRERELEASE]})?${u[a.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${u[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[a.XRANGEIDENTIFIERLOOSE]})(?:${u[a.PRERELEASELOOSE]})?${u[a.BUILD]}?)?)?`),f("XRANGE",`^${u[a.GTLT]}\\s*${u[a.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${u[a.GTLT]}\\s*${u[a.XRANGEPLAINLOOSE]}$`),f("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),f("COERCE",`${u[a.COERCEPLAIN]}(?:$|[^\\d])`),f("COERCEFULL",u[a.COERCEPLAIN]+`(?:${u[a.PRERELEASE]})?(?:${u[a.BUILD]})?(?:$|[^\\d])`),f("COERCERTL",u[a.COERCE],!0),f("COERCERTLFULL",u[a.COERCEFULL],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${u[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",f("TILDE",`^${u[a.LONETILDE]}${u[a.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${u[a.LONETILDE]}${u[a.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${u[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",f("CARET",`^${u[a.LONECARET]}${u[a.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${u[a.LONECARET]}${u[a.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${u[a.GTLT]}\\s*(${u[a.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${u[a.GTLT]}\\s*(${u[a.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${u[a.GTLT]}\\s*(${u[a.LOOSEPLAIN]}|${u[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${u[a.XRANGEPLAIN]})\\s+-\\s+(${u[a.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${u[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[a.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(ee,ee.exports)),ee.exports}var ge,Xe;function Yt(){if(Xe)return ge;Xe=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return ge=r=>r?typeof r!="object"?e:r:t,ge}var be,ze;function Zt(){if(ze)return be;ze=1;const e=/^[0-9]+$/,t=(r,s)=>{if(typeof r=="number"&&typeof s=="number")return r===s?0:r<s?-1:1;const o=e.test(r),i=e.test(s);return o&&i&&(r=+r,s=+s),r===s?0:o&&!i?-1:i&&!o?1:r<s?-1:1};return be={compareIdentifiers:t,rcompareIdentifiers:(r,s)=>t(s,r)},be}var ye,Ve;function Ke(){if(Ve)return ye;Ve=1;const e=je(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:n}=He(),{safeRe:r,t:s}=Wt(),o=Yt(),{compareIdentifiers:i}=Zt();class l{constructor(c,a){if(a=o(a),c instanceof l){if(c.loose===!!a.loose&&c.includePrerelease===!!a.includePrerelease)return c;c=c.version}else if(typeof c!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof c}".`);if(c.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",c,a),this.options=a,this.loose=!!a.loose,this.includePrerelease=!!a.includePrerelease;const p=c.trim().match(a.loose?r[s.LOOSE]:r[s.FULL]);if(!p)throw new TypeError(`Invalid Version: ${c}`);if(this.raw=c,this.major=+p[1],this.minor=+p[2],this.patch=+p[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");p[4]?this.prerelease=p[4].split(".").map(m=>{if(/^[0-9]+$/.test(m)){const b=+m;if(b>=0&&b<n)return b}return m}):this.prerelease=[],this.build=p[5]?p[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(c){if(e("SemVer.compare",this.version,this.options,c),!(c instanceof l)){if(typeof c=="string"&&c===this.version)return 0;c=new l(c,this.options)}return c.version===this.version?0:this.compareMain(c)||this.comparePre(c)}compareMain(c){return c instanceof l||(c=new l(c,this.options)),this.major<c.major?-1:this.major>c.major?1:this.minor<c.minor?-1:this.minor>c.minor?1:this.patch<c.patch?-1:this.patch>c.patch?1:0}comparePre(c){if(c instanceof l||(c=new l(c,this.options)),this.prerelease.length&&!c.prerelease.length)return-1;if(!this.prerelease.length&&c.prerelease.length)return 1;if(!this.prerelease.length&&!c.prerelease.length)return 0;let a=0;do{const p=this.prerelease[a],m=c.prerelease[a];if(e("prerelease compare",a,p,m),p===void 0&&m===void 0)return 0;if(m===void 0)return 1;if(p===void 0)return-1;if(p===m)continue;return i(p,m)}while(++a)}compareBuild(c){c instanceof l||(c=new l(c,this.options));let a=0;do{const p=this.build[a],m=c.build[a];if(e("build compare",a,p,m),p===void 0&&m===void 0)return 0;if(m===void 0)return 1;if(p===void 0)return-1;if(p===m)continue;return i(p,m)}while(++a)}inc(c,a,p){if(c.startsWith("pre")){if(!a&&p===!1)throw new Error("invalid increment argument: identifier is empty");if(a){const m=`-${a}`.match(this.options.loose?r[s.PRERELEASELOOSE]:r[s.PRERELEASE]);if(!m||m[1]!==a)throw new Error(`invalid identifier: ${a}`)}}switch(c){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",a,p);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",a,p);break;case"prepatch":this.prerelease.length=0,this.inc("patch",a,p),this.inc("pre",a,p);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",a,p),this.inc("pre",a,p);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const m=Number(p)?1:0;if(this.prerelease.length===0)this.prerelease=[m];else{let b=this.prerelease.length;for(;--b>=0;)typeof this.prerelease[b]=="number"&&(this.prerelease[b]++,b=-2);if(b===-1){if(a===this.prerelease.join(".")&&p===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(m)}}if(a){let b=[a,m];p===!1&&(b=[a]),i(this.prerelease[0],a)===0?isNaN(this.prerelease[1])&&(this.prerelease=b):this.prerelease=b}break}default:throw new Error(`invalid increment argument: ${c}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return ye=l,ye}var Re,Je;function Qt(){if(Je)return Re;Je=1;const e=Ke();return Re=(n,r)=>new e(n,r).major,Re}var en=Qt();const We=Be(en);var we,Ye;function tn(){if(Ye)return we;Ye=1;const e=Ke();return we=(n,r,s=!1)=>{if(n instanceof e)return n;try{return new e(n,r)}catch(o){if(!s)return null;throw o}},we}var Oe,Ze;function nn(){if(Ze)return Oe;Ze=1;const e=tn();return Oe=(n,r)=>{const s=e(n,r);return s?s.version:null},Oe}var rn=nn();const sn=Be(rn);class on{bus;constructor(t){typeof t.getVersion!="function"||!sn(t.getVersion())?console.warn("Proxying an event bus with an unknown or invalid version"):We(t.getVersion())!==We(this.getVersion())&&console.warn("Proxying an event bus of version "+t.getVersion()+" with "+this.getVersion()),this.bus=t}getVersion(){return"3.3.3"}subscribe(t,n){this.bus.subscribe(t,n)}unsubscribe(t,n){this.bus.unsubscribe(t,n)}emit(t,...n){this.bus.emit(t,...n)}}class an{handlers=new Map;getVersion(){return"3.3.3"}subscribe(t,n){this.handlers.set(t,(this.handlers.get(t)||[]).concat(n))}unsubscribe(t,n){this.handlers.set(t,(this.handlers.get(t)||[]).filter(r=>r!==n))}emit(t,...n){(this.handlers.get(t)||[]).forEach(s=>{try{s(n[0])}catch(o){console.error("could not invoke event listener",o)}})}}let G=null;function cn(){return G!==null?G:typeof window>"u"?new Proxy({},{get:()=>()=>console.error("Window not available, EventBus can not be established!")}):(window.OC?._eventBus&&typeof window._nc_event_bus>"u"&&(console.warn("found old event bus instance at OC._eventBus. Update your version!"),window._nc_event_bus=window.OC._eventBus),typeof window?._nc_event_bus<"u"?G=new on(window._nc_event_bus):G=window._nc_event_bus=new an,G)}function ln(e,t){cn().subscribe(e,t)}class te{static GLOBAL_SCOPE_VOLATILE="nextcloud_vol";static GLOBAL_SCOPE_PERSISTENT="nextcloud_per";scope;wrapped;constructor(t,n,r){this.scope=`${r?te.GLOBAL_SCOPE_PERSISTENT:te.GLOBAL_SCOPE_VOLATILE}_${btoa(t)}_`,this.wrapped=n}scopeKey(t){return`${this.scope}${t}`}setItem(t,n){this.wrapped.setItem(this.scopeKey(t),n)}getItem(t){return this.wrapped.getItem(this.scopeKey(t))}removeItem(t){this.wrapped.removeItem(this.scopeKey(t))}clear(){Object.keys(this.wrapped).filter(t=>t.startsWith(this.scope)).map(this.wrapped.removeItem.bind(this.wrapped))}}class un{appId;persisted=!1;clearedOnLogout=!1;constructor(t){this.appId=t}persist(t=!0){return this.persisted=t,this}clearOnLogout(t=!0){return this.clearedOnLogout=t,this}build(){return new te(this.appId,this.persisted?window.localStorage:window.sessionStorage,!this.clearedOnLogout)}}function dn(e){return new un(e)}let X;const Qe=[];function fn(){return X===void 0&&(X=document.head.dataset.requesttoken??null),X}function pn(e){Qe.push(e)}ln("csrf-token-update",e=>{X=e.token,Qe.forEach(t=>{try{t(X)}catch(n){console.error("Error updating CSRF token observer",n)}})});dn("public").persist().build();function et(e,t){return function(){return e.apply(t,arguments)}}const{toString:hn}=Object.prototype,{getPrototypeOf:Se}=Object,{iterator:ne,toStringTag:tt}=Symbol,re=(e=>t=>{const n=hn.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),C=e=>(e=e.toLowerCase(),t=>re(t)===e),se=e=>t=>typeof t===e,{isArray:M}=Array,j=se("undefined");function z(e){return e!==null&&!j(e)&&e.constructor!==null&&!j(e.constructor)&&I(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const nt=C("ArrayBuffer");function En(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&nt(e.buffer),t}const mn=se("string"),I=se("function"),rt=se("number"),V=e=>e!==null&&typeof e=="object",gn=e=>e===!0||e===!1,oe=e=>{if(re(e)!=="object")return!1;const t=Se(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(tt in e)&&!(ne in e)},bn=e=>{if(!V(e)||z(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},yn=C("Date"),Rn=C("File"),wn=C("Blob"),On=C("FileList"),Sn=e=>V(e)&&I(e.pipe),An=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||I(e.append)&&((t=re(e))==="formdata"||t==="object"&&I(e.toString)&&e.toString()==="[object FormData]"))},Tn=C("URLSearchParams"),[In,Ln,Nn,Cn]=["ReadableStream","Request","Response","Headers"].map(C),xn=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function K(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,s;if(typeof e!="object"&&(e=[e]),M(e))for(r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else{if(z(e))return;const o=n?Object.getOwnPropertyNames(e):Object.keys(e),i=o.length;let l;for(r=0;r<i;r++)l=o[r],t.call(null,e[l],l,e)}}function st(e,t){if(z(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r=n.length,s;for(;r-- >0;)if(s=n[r],t===s.toLowerCase())return s;return null}const k=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ot=e=>!j(e)&&e!==k;function Ae(){const{caseless:e,skipUndefined:t}=ot(this)&&this||{},n={},r=(s,o)=>{const i=e&&st(n,o)||o;oe(n[i])&&oe(s)?n[i]=Ae(n[i],s):oe(s)?n[i]=Ae({},s):M(s)?n[i]=s.slice():(!t||!j(s))&&(n[i]=s)};for(let s=0,o=arguments.length;s<o;s++)arguments[s]&&K(arguments[s],r);return n}const _n=(e,t,n,{allOwnKeys:r}={})=>(K(t,(s,o)=>{n&&I(s)?Object.defineProperty(e,o,{value:et(s,n),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(e,o,{value:s,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:r}),e),Pn=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),vn=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},$n=(e,t,n,r)=>{let s,o,i;const l={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),o=s.length;o-- >0;)i=s[o],(!r||r(i,e,t))&&!l[i]&&(t[i]=e[i],l[i]=!0);e=n!==!1&&Se(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kn=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},Fn=e=>{if(!e)return null;if(M(e))return e;let t=e.length;if(!rt(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Un=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Se(Uint8Array)),Dn=(e,t)=>{const r=(e&&e[ne]).call(e);let s;for(;(s=r.next())&&!s.done;){const o=s.value;t.call(e,o[0],o[1])}},Bn=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},Mn=C("HTMLFormElement"),jn=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),it=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),qn=C("RegExp"),at=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};K(n,(s,o)=>{let i;(i=t(s,o,e))!==!1&&(r[o]=i||s)}),Object.defineProperties(e,r)},Hn=e=>{at(e,(t,n)=>{if(I(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(I(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Gn=(e,t)=>{const n={},r=s=>{s.forEach(o=>{n[o]=!0})};return M(e)?r(e):r(String(e).split(t)),n},Xn=()=>{},zn=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Vn(e){return!!(e&&I(e.append)&&e[tt]==="FormData"&&e[ne])}const Kn=e=>{const t=new Array(10),n=(r,s)=>{if(V(r)){if(t.indexOf(r)>=0)return;if(z(r))return r;if(!("toJSON"in r)){t[s]=r;const o=M(r)?[]:{};return K(r,(i,l)=>{const u=n(i,s+1);!j(u)&&(o[l]=u)}),t[s]=void 0,o}}return r};return n(e,0)},Jn=C("AsyncFunction"),Wn=e=>e&&(V(e)||I(e))&&I(e.then)&&I(e.catch),ct=((e,t)=>e?setImmediate:t?((n,r)=>(k.addEventListener("message",({source:s,data:o})=>{s===k&&o===n&&r.length&&r.shift()()},!1),s=>{r.push(s),k.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",I(k.postMessage)),Yn=typeof queueMicrotask<"u"?queueMicrotask.bind(k):typeof process<"u"&&process.nextTick||ct,d={isArray:M,isArrayBuffer:nt,isBuffer:z,isFormData:An,isArrayBufferView:En,isString:mn,isNumber:rt,isBoolean:gn,isObject:V,isPlainObject:oe,isEmptyObject:bn,isReadableStream:In,isRequest:Ln,isResponse:Nn,isHeaders:Cn,isUndefined:j,isDate:yn,isFile:Rn,isBlob:wn,isRegExp:qn,isFunction:I,isStream:Sn,isURLSearchParams:Tn,isTypedArray:Un,isFileList:On,forEach:K,merge:Ae,extend:_n,trim:xn,stripBOM:Pn,inherits:vn,toFlatObject:$n,kindOf:re,kindOfTest:C,endsWith:kn,toArray:Fn,forEachEntry:Dn,matchAll:Bn,isHTMLForm:Mn,hasOwnProperty:it,hasOwnProp:it,reduceDescriptors:at,freezeMethods:Hn,toObjectSet:Gn,toCamelCase:jn,noop:Xn,toFiniteNumber:zn,findKey:st,global:k,isContextDefined:ot,isSpecCompliantForm:Vn,toJSONObject:Kn,isAsyncFn:Jn,isThenable:Wn,setImmediate:ct,asap:Yn,isIterable:e=>e!=null&&I(e[ne])};let g=class zt extends Error{static from(t,n,r,s,o,i){const l=new zt(t.message,n||t.code,r,s,o);return l.cause=t,l.name=t.name,i&&Object.assign(l,i),l}constructor(t,n,r,s,o){super(t),this.name="AxiosError",this.isAxiosError=!0,n&&(this.code=n),r&&(this.config=r),s&&(this.request=s),o&&(this.response=o,this.status=o.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:d.toJSONObject(this.config),code:this.code,status:this.status}}};g.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE",g.ERR_BAD_OPTION="ERR_BAD_OPTION",g.ECONNABORTED="ECONNABORTED",g.ETIMEDOUT="ETIMEDOUT",g.ERR_NETWORK="ERR_NETWORK",g.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS",g.ERR_DEPRECATED="ERR_DEPRECATED",g.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE",g.ERR_BAD_REQUEST="ERR_BAD_REQUEST",g.ERR_CANCELED="ERR_CANCELED",g.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT",g.ERR_INVALID_URL="ERR_INVALID_URL";const Zn=null;function Te(e){return d.isPlainObject(e)||d.isArray(e)}function lt(e){return d.endsWith(e,"[]")?e.slice(0,-2):e}function ut(e,t,n){return e?e.concat(t).map(function(s,o){return s=lt(s),!n&&o?"["+s+"]":s}).join(n?".":""):t}function Qn(e){return d.isArray(e)&&!e.some(Te)}const er=d.toFlatObject(d,{},null,function(t){return/^is[A-Z]/.test(t)});function ie(e,t,n){if(!d.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=d.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(f,E){return!d.isUndefined(E[f])});const r=n.metaTokens,s=n.visitor||a,o=n.dots,i=n.indexes,u=(n.Blob||typeof Blob<"u"&&Blob)&&d.isSpecCompliantForm(t);if(!d.isFunction(s))throw new TypeError("visitor must be a function");function c(h){if(h===null)return"";if(d.isDate(h))return h.toISOString();if(d.isBoolean(h))return h.toString();if(!u&&d.isBlob(h))throw new g("Blob is not supported. Use a Buffer instead.");return d.isArrayBuffer(h)||d.isTypedArray(h)?u&&typeof Blob=="function"?new Blob([h]):Buffer.from(h):h}function a(h,f,E){let y=h;if(h&&!E&&typeof h=="object"){if(d.endsWith(f,"{}"))f=r?f:f.slice(0,-2),h=JSON.stringify(h);else if(d.isArray(h)&&Qn(h)||(d.isFileList(h)||d.endsWith(f,"[]"))&&(y=d.toArray(h)))return f=lt(f),y.forEach(function(R,w){!(d.isUndefined(R)||R===null)&&t.append(i===!0?ut([f],w,o):i===null?f:f+"[]",c(R))}),!1}return Te(h)?!0:(t.append(ut(E,f,o),c(h)),!1)}const p=[],m=Object.assign(er,{defaultVisitor:a,convertValue:c,isVisitable:Te});function b(h,f){if(!d.isUndefined(h)){if(p.indexOf(h)!==-1)throw Error("Circular reference detected in "+f.join("."));p.push(h),d.forEach(h,function(y,S){(!(d.isUndefined(y)||y===null)&&s.call(t,y,d.isString(S)?S.trim():S,f,m))===!0&&b(y,f?f.concat(S):[S])}),p.pop()}}if(!d.isObject(e))throw new TypeError("data must be an object");return b(e),t}function dt(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function Ie(e,t){this._pairs=[],e&&ie(e,this,t)}const ft=Ie.prototype;ft.append=function(t,n){this._pairs.push([t,n])},ft.toString=function(t){const n=t?function(r){return t.call(this,r,dt)}:dt;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function tr(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function pt(e,t,n){if(!t)return e;const r=n&&n.encode||tr,s=d.isFunction(n)?{serialize:n}:n,o=s&&s.serialize;let i;if(o?i=o(t,s):i=d.isURLSearchParams(t)?t.toString():new Ie(t,s).toString(r),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class ht{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){d.forEach(this.handlers,function(r){r!==null&&t(r)})}}const Et={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},nr={isBrowser:!0,classes:{URLSearchParams:typeof URLSearchParams<"u"?URLSearchParams:Ie,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]},Le=typeof window<"u"&&typeof document<"u",Ne=typeof navigator=="object"&&navigator||void 0,rr=Le&&(!Ne||["ReactNative","NativeScript","NS"].indexOf(Ne.product)<0),sr=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",or=Le&&window.location.href||"http://localhost",A={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Le,hasStandardBrowserEnv:rr,hasStandardBrowserWebWorkerEnv:sr,navigator:Ne,origin:or},Symbol.toStringTag,{value:"Module"})),...nr};function ir(e,t){return ie(e,new A.classes.URLSearchParams,{visitor:function(n,r,s,o){return A.isNode&&d.isBuffer(n)?(this.append(r,n.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...t})}function ar(e){return d.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function cr(e){const t={},n=Object.keys(e);let r;const s=n.length;let o;for(r=0;r<s;r++)o=n[r],t[o]=e[o];return t}function mt(e){function t(n,r,s,o){let i=n[o++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),u=o>=n.length;return i=!i&&d.isArray(s)?s.length:i,u?(d.hasOwnProp(s,i)?s[i]=[s[i],r]:s[i]=r,!l):((!s[i]||!d.isObject(s[i]))&&(s[i]=[]),t(n,r,s[i],o)&&d.isArray(s[i])&&(s[i]=cr(s[i])),!l)}if(d.isFormData(e)&&d.isFunction(e.entries)){const n={};return d.forEachEntry(e,(r,s)=>{t(ar(r),s,n,0)}),n}return null}function lr(e,t,n){if(d.isString(e))try{return(t||JSON.parse)(e),d.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const J={transitional:Et,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,o=d.isObject(t);if(o&&d.isHTMLForm(t)&&(t=new FormData(t)),d.isFormData(t))return s?JSON.stringify(mt(t)):t;if(d.isArrayBuffer(t)||d.isBuffer(t)||d.isStream(t)||d.isFile(t)||d.isBlob(t)||d.isReadableStream(t))return t;if(d.isArrayBufferView(t))return t.buffer;if(d.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return ir(t,this.formSerializer).toString();if((l=d.isFileList(t))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return ie(l?{"files[]":t}:t,u&&new u,this.formSerializer)}}return o||s?(n.setContentType("application/json",!1),lr(t)):t}],transformResponse:[function(t){const n=this.transitional||J.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(d.isResponse(t)||d.isReadableStream(t))return t;if(t&&d.isString(t)&&(r&&!this.responseType||s)){const i=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(l){if(i)throw l.name==="SyntaxError"?g.from(l,g.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:A.classes.FormData,Blob:A.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};d.forEach(["delete","get","head","post","put","patch"],e=>{J.headers[e]={}});const ur=d.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),dr=e=>{const t={};let n,r,s;return e&&e.split(`
`).forEach(function(i){s=i.indexOf(":"),n=i.substring(0,s).trim().toLowerCase(),r=i.substring(s+1).trim(),!(!n||t[n]&&ur[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},gt=Symbol("internals");function W(e){return e&&String(e).trim().toLowerCase()}function ae(e){return e===!1||e==null?e:d.isArray(e)?e.map(ae):String(e)}function fr(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const pr=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ce(e,t,n,r,s){if(d.isFunction(r))return r.call(this,t,n);if(s&&(t=n),!!d.isString(t)){if(d.isString(r))return t.indexOf(r)!==-1;if(d.isRegExp(r))return r.test(t)}}function hr(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function Er(e,t){const n=d.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(s,o,i){return this[r].call(this,t,s,o,i)},configurable:!0})})}let L=class{constructor(t){t&&this.set(t)}set(t,n,r){const s=this;function o(l,u,c){const a=W(u);if(!a)throw new Error("header name must be a non-empty string");const p=d.findKey(s,a);(!p||s[p]===void 0||c===!0||c===void 0&&s[p]!==!1)&&(s[p||u]=ae(l))}const i=(l,u)=>d.forEach(l,(c,a)=>o(c,a,u));if(d.isPlainObject(t)||t instanceof this.constructor)i(t,n);else if(d.isString(t)&&(t=t.trim())&&!pr(t))i(dr(t),n);else if(d.isObject(t)&&d.isIterable(t)){let l={},u,c;for(const a of t){if(!d.isArray(a))throw TypeError("Object iterator must return a key-value pair");l[c=a[0]]=(u=l[c])?d.isArray(u)?[...u,a[1]]:[u,a[1]]:a[1]}i(l,n)}else t!=null&&o(n,t,r);return this}get(t,n){if(t=W(t),t){const r=d.findKey(this,t);if(r){const s=this[r];if(!n)return s;if(n===!0)return fr(s);if(d.isFunction(n))return n.call(this,s,r);if(d.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=W(t),t){const r=d.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||Ce(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let s=!1;function o(i){if(i=W(i),i){const l=d.findKey(r,i);l&&(!n||Ce(r,r[l],l,n))&&(delete r[l],s=!0)}}return d.isArray(t)?t.forEach(o):o(t),s}clear(t){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const o=n[r];(!t||Ce(this,this[o],o,t,!0))&&(delete this[o],s=!0)}return s}normalize(t){const n=this,r={};return d.forEach(this,(s,o)=>{const i=d.findKey(r,o);if(i){n[i]=ae(s),delete n[o];return}const l=t?hr(o):String(o).trim();l!==o&&delete n[o],n[l]=ae(s),r[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return d.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=t&&d.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(s=>r.set(s)),r}static accessor(t){const r=(this[gt]=this[gt]={accessors:{}}).accessors,s=this.prototype;function o(i){const l=W(i);r[l]||(Er(s,i),r[l]=!0)}return d.isArray(t)?t.forEach(o):o(t),this}};L.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),d.reduceDescriptors(L.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}}),d.freezeMethods(L);function xe(e,t){const n=this||J,r=t||n,s=L.from(r.headers);let o=r.data;return d.forEach(e,function(l){o=l.call(n,o,s.normalize(),t?t.status:void 0)}),s.normalize(),o}function bt(e){return!!(e&&e.__CANCEL__)}let Y=class extends g{constructor(t,n,r){super(t??"canceled",g.ERR_CANCELED,n,r),this.name="CanceledError",this.__CANCEL__=!0}};function yt(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new g("Request failed with status code "+n.status,[g.ERR_BAD_REQUEST,g.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function mr(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function gr(e,t){e=e||10;const n=new Array(e),r=new Array(e);let s=0,o=0,i;return t=t!==void 0?t:1e3,function(u){const c=Date.now(),a=r[o];i||(i=c),n[s]=u,r[s]=c;let p=o,m=0;for(;p!==s;)m+=n[p++],p=p%e;if(s=(s+1)%e,s===o&&(o=(o+1)%e),c-i<t)return;const b=a&&c-a;return b?Math.round(m*1e3/b):void 0}}function br(e,t){let n=0,r=1e3/t,s,o;const i=(c,a=Date.now())=>{n=a,s=null,o&&(clearTimeout(o),o=null),e(...c)};return[(...c)=>{const a=Date.now(),p=a-n;p>=r?i(c,a):(s=c,o||(o=setTimeout(()=>{o=null,i(s)},r-p)))},()=>s&&i(s)]}const ce=(e,t,n=3)=>{let r=0;const s=gr(50,250);return br(o=>{const i=o.loaded,l=o.lengthComputable?o.total:void 0,u=i-r,c=s(u),a=i<=l;r=i;const p={loaded:i,total:l,progress:l?i/l:void 0,bytes:u,rate:c||void 0,estimated:c&&l&&a?(l-i)/c:void 0,event:o,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(p)},n)},Rt=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},wt=e=>(...t)=>d.asap(()=>e(...t)),yr=A.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,A.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(A.origin),A.navigator&&/(msie|trident)/i.test(A.navigator.userAgent)):()=>!0,Rr=A.hasStandardBrowserEnv?{write(e,t,n,r,s,o,i){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];d.isNumber(n)&&l.push(`expires=${new Date(n).toUTCString()}`),d.isString(r)&&l.push(`path=${r}`),d.isString(s)&&l.push(`domain=${s}`),o===!0&&l.push("secure"),d.isString(i)&&l.push(`SameSite=${i}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function wr(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Or(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Ot(e,t,n){let r=!wr(t);return e&&(r||n==!1)?Or(e,t):t}const St=e=>e instanceof L?{...e}:e;function F(e,t){t=t||{};const n={};function r(c,a,p,m){return d.isPlainObject(c)&&d.isPlainObject(a)?d.merge.call({caseless:m},c,a):d.isPlainObject(a)?d.merge({},a):d.isArray(a)?a.slice():a}function s(c,a,p,m){if(d.isUndefined(a)){if(!d.isUndefined(c))return r(void 0,c,p,m)}else return r(c,a,p,m)}function o(c,a){if(!d.isUndefined(a))return r(void 0,a)}function i(c,a){if(d.isUndefined(a)){if(!d.isUndefined(c))return r(void 0,c)}else return r(void 0,a)}function l(c,a,p){if(p in t)return r(c,a);if(p in e)return r(void 0,c)}const u={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(c,a,p)=>s(St(c),St(a),p,!0)};return d.forEach(Object.keys({...e,...t}),function(a){const p=u[a]||s,m=p(e[a],t[a],a);d.isUndefined(m)&&p!==l||(n[a]=m)}),n}const At=e=>{const t=F({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:o,headers:i,auth:l}=t;if(t.headers=i=L.from(i),t.url=pt(Ot(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),d.isFormData(n)){if(A.hasStandardBrowserEnv||A.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(d.isFunction(n.getHeaders)){const u=n.getHeaders(),c=["content-type","content-length"];Object.entries(u).forEach(([a,p])=>{c.includes(a.toLowerCase())&&i.set(a,p)})}}if(A.hasStandardBrowserEnv&&(r&&d.isFunction(r)&&(r=r(t)),r||r!==!1&&yr(t.url))){const u=s&&o&&Rr.read(o);u&&i.set(s,u)}return t},Sr=typeof XMLHttpRequest<"u"&&function(e){return new Promise(function(n,r){const s=At(e);let o=s.data;const i=L.from(s.headers).normalize();let{responseType:l,onUploadProgress:u,onDownloadProgress:c}=s,a,p,m,b,h;function f(){b&&b(),h&&h(),s.cancelToken&&s.cancelToken.unsubscribe(a),s.signal&&s.signal.removeEventListener("abort",a)}let E=new XMLHttpRequest;E.open(s.method.toUpperCase(),s.url,!0),E.timeout=s.timeout;function y(){if(!E)return;const R=L.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),T={data:!l||l==="text"||l==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:R,config:e,request:E};yt(function(N){n(N),f()},function(N){r(N),f()},T),E=null}"onloadend"in E?E.onloadend=y:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(y)},E.onabort=function(){E&&(r(new g("Request aborted",g.ECONNABORTED,e,E)),E=null)},E.onerror=function(w){const T=w&&w.message?w.message:"Network Error",D=new g(T,g.ERR_NETWORK,e,E);D.event=w||null,r(D),E=null},E.ontimeout=function(){let w=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const T=s.transitional||Et;s.timeoutErrorMessage&&(w=s.timeoutErrorMessage),r(new g(w,T.clarifyTimeoutError?g.ETIMEDOUT:g.ECONNABORTED,e,E)),E=null},o===void 0&&i.setContentType(null),"setRequestHeader"in E&&d.forEach(i.toJSON(),function(w,T){E.setRequestHeader(T,w)}),d.isUndefined(s.withCredentials)||(E.withCredentials=!!s.withCredentials),l&&l!=="json"&&(E.responseType=s.responseType),c&&([m,h]=ce(c,!0),E.addEventListener("progress",m)),u&&E.upload&&([p,b]=ce(u),E.upload.addEventListener("progress",p),E.upload.addEventListener("loadend",b)),(s.cancelToken||s.signal)&&(a=R=>{E&&(r(!R||R.type?new Y(null,e,E):R),E.abort(),E=null)},s.cancelToken&&s.cancelToken.subscribe(a),s.signal&&(s.signal.aborted?a():s.signal.addEventListener("abort",a)));const S=mr(s.url);if(S&&A.protocols.indexOf(S)===-1){r(new g("Unsupported protocol "+S+":",g.ERR_BAD_REQUEST,e));return}E.send(o||null)})},Ar=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,s;const o=function(c){if(!s){s=!0,l();const a=c instanceof Error?c:this.reason;r.abort(a instanceof g?a:new Y(a instanceof Error?a.message:a))}};let i=t&&setTimeout(()=>{i=null,o(new g(`timeout of ${t}ms exceeded`,g.ETIMEDOUT))},t);const l=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(c=>{c.unsubscribe?c.unsubscribe(o):c.removeEventListener("abort",o)}),e=null)};e.forEach(c=>c.addEventListener("abort",o));const{signal:u}=r;return u.unsubscribe=()=>d.asap(l),u}},Tr=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,s;for(;r<n;)s=r+t,yield e.slice(r,s),r=s},Ir=async function*(e,t){for await(const n of Lr(e))yield*Tr(n,t)},Lr=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},Tt=(e,t,n,r)=>{const s=Ir(e,t);let o=0,i,l=u=>{i||(i=!0,r&&r(u))};return new ReadableStream({async pull(u){try{const{done:c,value:a}=await s.next();if(c){l(),u.close();return}let p=a.byteLength;if(n){let m=o+=p;n(m)}u.enqueue(new Uint8Array(a))}catch(c){throw l(c),c}},cancel(u){return l(u),s.return()}},{highWaterMark:2})},It=64*1024,{isFunction:le}=d,Nr=(({Request:e,Response:t})=>({Request:e,Response:t}))(d.global),{ReadableStream:Lt,TextEncoder:Nt}=d.global,Ct=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Cr=e=>{e=d.merge.call({skipUndefined:!0},Nr,e);const{fetch:t,Request:n,Response:r}=e,s=t?le(t):typeof fetch=="function",o=le(n),i=le(r);if(!s)return!1;const l=s&&le(Lt),u=s&&(typeof Nt=="function"?(h=>f=>h.encode(f))(new Nt):async h=>new Uint8Array(await new n(h).arrayBuffer())),c=o&&l&&Ct(()=>{let h=!1;const f=new n(A.origin,{body:new Lt,method:"POST",get duplex(){return h=!0,"half"}}).headers.has("Content-Type");return h&&!f}),a=i&&l&&Ct(()=>d.isReadableStream(new r("").body)),p={stream:a&&(h=>h.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(h=>{!p[h]&&(p[h]=(f,E)=>{let y=f&&f[h];if(y)return y.call(f);throw new g(`Response type '${h}' is not supported`,g.ERR_NOT_SUPPORT,E)})});const m=async h=>{if(h==null)return 0;if(d.isBlob(h))return h.size;if(d.isSpecCompliantForm(h))return(await new n(A.origin,{method:"POST",body:h}).arrayBuffer()).byteLength;if(d.isArrayBufferView(h)||d.isArrayBuffer(h))return h.byteLength;if(d.isURLSearchParams(h)&&(h=h+""),d.isString(h))return(await u(h)).byteLength},b=async(h,f)=>{const E=d.toFiniteNumber(h.getContentLength());return E??m(f)};return async h=>{let{url:f,method:E,data:y,signal:S,cancelToken:R,timeout:w,onDownloadProgress:T,onUploadProgress:D,responseType:N,headers:Fe,withCredentials:fe="same-origin",fetchOptions:Mt}=At(h),jt=t||fetch;N=N?(N+"").toLowerCase():"text";let pe=Ar([S,R&&R.toAbortSignal()],w),Q=null;const B=pe&&pe.unsubscribe&&(()=>{pe.unsubscribe()});let qt;try{if(D&&c&&E!=="get"&&E!=="head"&&(qt=await b(Fe,y))!==0){let $=new n(f,{method:"POST",body:y,duplex:"half"}),q;if(d.isFormData(y)&&(q=$.headers.get("content-type"))&&Fe.setContentType(q),$.body){const[Ue,he]=Rt(qt,ce(wt(D)));y=Tt($.body,It,Ue,he)}}d.isString(fe)||(fe=fe?"include":"omit");const _=o&&"credentials"in n.prototype,Ht={...Mt,signal:pe,method:E.toUpperCase(),headers:Fe.normalize().toJSON(),body:y,duplex:"half",credentials:_?fe:void 0};Q=o&&new n(f,Ht);let v=await(o?jt(Q,Mt):jt(f,Ht));const Gt=a&&(N==="stream"||N==="response");if(a&&(T||Gt&&B)){const $={};["status","statusText","headers"].forEach(Xt=>{$[Xt]=v[Xt]});const q=d.toFiniteNumber(v.headers.get("content-length")),[Ue,he]=T&&Rt(q,ce(wt(T),!0))||[];v=new r(Tt(v.body,It,Ue,()=>{he&&he(),B&&B()}),$)}N=N||"text";let Hr=await p[d.findKey(p,N)||"text"](v,h);return!Gt&&B&&B(),await new Promise(($,q)=>{yt($,q,{data:Hr,headers:L.from(v.headers),status:v.status,statusText:v.statusText,config:h,request:Q})})}catch(_){throw B&&B(),_&&_.name==="TypeError"&&/Load failed|fetch/i.test(_.message)?Object.assign(new g("Network Error",g.ERR_NETWORK,h,Q),{cause:_.cause||_}):g.from(_,_&&_.code,h,Q)}}},xr=new Map,xt=e=>{let t=e&&e.env||{};const{fetch:n,Request:r,Response:s}=t,o=[r,s,n];let i=o.length,l=i,u,c,a=xr;for(;l--;)u=o[l],c=a.get(u),c===void 0&&a.set(u,c=l?new Map:Cr(t)),a=c;return c};xt();const _e={http:Zn,xhr:Sr,fetch:{get:xt}};d.forEach(_e,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const _t=e=>`- ${e}`,_r=e=>d.isFunction(e)||e===null||e===!1;function Pr(e,t){e=d.isArray(e)?e:[e];const{length:n}=e;let r,s;const o={};for(let i=0;i<n;i++){r=e[i];let l;if(s=r,!_r(r)&&(s=_e[(l=String(r)).toLowerCase()],s===void 0))throw new g(`Unknown adapter '${l}'`);if(s&&(d.isFunction(s)||(s=s.get(t))))break;o[l||"#"+i]=s}if(!s){const i=Object.entries(o).map(([u,c])=>`adapter ${u} `+(c===!1?"is not supported by the environment":"is not available in the build"));let l=n?i.length>1?`since :
`+i.map(_t).join(`
`):" "+_t(i[0]):"as no adapter specified";throw new g("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return s}const Pt={getAdapter:Pr,adapters:_e};function Pe(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Y(null,e)}function vt(e){return Pe(e),e.headers=L.from(e.headers),e.data=xe.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Pt.getAdapter(e.adapter||J.adapter,e)(e).then(function(r){return Pe(e),r.data=xe.call(e,e.transformResponse,r),r.headers=L.from(r.headers),r},function(r){return bt(r)||(Pe(e),r&&r.response&&(r.response.data=xe.call(e,e.transformResponse,r.response),r.response.headers=L.from(r.response.headers))),Promise.reject(r)})}const $t="1.13.4",ue={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{ue[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const kt={};ue.transitional=function(t,n,r){function s(o,i){return"[Axios v"+$t+"] Transitional option '"+o+"'"+i+(r?". "+r:"")}return(o,i,l)=>{if(t===!1)throw new g(s(i," has been removed"+(n?" in "+n:"")),g.ERR_DEPRECATED);return n&&!kt[i]&&(kt[i]=!0,console.warn(s(i," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(o,i,l):!0}},ue.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function vr(e,t,n){if(typeof e!="object")throw new g("options must be an object",g.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const o=r[s],i=t[o];if(i){const l=e[o],u=l===void 0||i(l,o,e);if(u!==!0)throw new g("option "+o+" must be "+u,g.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new g("Unknown option "+o,g.ERR_BAD_OPTION)}}const de={assertOptions:vr,validators:ue},x=de.validators;let U=class{constructor(t){this.defaults=t||{},this.interceptors={request:new ht,response:new ht}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const o=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=F(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:o}=n;r!==void 0&&de.assertOptions(r,{silentJSONParsing:x.transitional(x.boolean),forcedJSONParsing:x.transitional(x.boolean),clarifyTimeoutError:x.transitional(x.boolean)},!1),s!=null&&(d.isFunction(s)?n.paramsSerializer={serialize:s}:de.assertOptions(s,{encode:x.function,serialize:x.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),de.assertOptions(n,{baseUrl:x.spelling("baseURL"),withXsrfToken:x.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let i=o&&d.merge(o.common,o[n.method]);o&&d.forEach(["delete","get","head","post","put","patch","common"],h=>{delete o[h]}),n.headers=L.concat(i,o);const l=[];let u=!0;this.interceptors.request.forEach(function(f){typeof f.runWhen=="function"&&f.runWhen(n)===!1||(u=u&&f.synchronous,l.unshift(f.fulfilled,f.rejected))});const c=[];this.interceptors.response.forEach(function(f){c.push(f.fulfilled,f.rejected)});let a,p=0,m;if(!u){const h=[vt.bind(this),void 0];for(h.unshift(...l),h.push(...c),m=h.length,a=Promise.resolve(n);p<m;)a=a.then(h[p++],h[p++]);return a}m=l.length;let b=n;for(;p<m;){const h=l[p++],f=l[p++];try{b=h(b)}catch(E){f.call(this,E);break}}try{a=vt.call(this,b)}catch(h){return Promise.reject(h)}for(p=0,m=c.length;p<m;)a=a.then(c[p++],c[p++]);return a}getUri(t){t=F(this.defaults,t);const n=Ot(t.baseURL,t.url,t.allowAbsoluteUrls);return pt(n,t.params,t.paramsSerializer)}};d.forEach(["delete","get","head","options"],function(t){U.prototype[t]=function(n,r){return this.request(F(r||{},{method:t,url:n,data:(r||{}).data}))}}),d.forEach(["post","put","patch"],function(t){function n(r){return function(o,i,l){return this.request(F(l||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}U.prototype[t]=n(),U.prototype[t+"Form"]=n(!0)});let $r=class Vt{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(o){n=o});const r=this;this.promise.then(s=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](s);r._listeners=null}),this.promise.then=s=>{let o;const i=new Promise(l=>{r.subscribe(l),o=l}).then(s);return i.cancel=function(){r.unsubscribe(o)},i},t(function(o,i,l){r.reason||(r.reason=new Y(o,i,l),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Vt(function(s){t=s}),cancel:t}}};function kr(e){return function(n){return e.apply(null,n)}}function Fr(e){return d.isObject(e)&&e.isAxiosError===!0}const ve={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(ve).forEach(([e,t])=>{ve[t]=e});function Ft(e){const t=new U(e),n=et(U.prototype.request,t);return d.extend(n,U.prototype,t,{allOwnKeys:!0}),d.extend(n,t,null,{allOwnKeys:!0}),n.create=function(s){return Ft(F(e,s))},n}const O=Ft(J);O.Axios=U,O.CanceledError=Y,O.CancelToken=$r,O.isCancel=bt,O.VERSION=$t,O.toFormData=ie,O.AxiosError=g,O.Cancel=O.CanceledError,O.all=function(t){return Promise.all(t)},O.spread=kr,O.isAxiosError=Fr,O.mergeConfig=F,O.AxiosHeaders=L,O.formToJSON=e=>mt(d.isHTMLForm(e)?new FormData(e):e),O.getAdapter=Pt.getAdapter,O.HttpStatusCode=ve,O.default=O;const{Axios:Wr,AxiosError:Yr,CanceledError:Zr,isCancel:Qr,CancelToken:es,VERSION:ts,all:ns,Cancel:rs,isAxiosError:$e,spread:ss,toFormData:os,AxiosHeaders:is,HttpStatusCode:as,formToJSON:cs,getAdapter:ls,mergeConfig:us}=O;const Ut=O.create({headers:{requesttoken:fn()??"","X-Requested-With":"XMLHttpRequest"}});pn(e=>{Ut.defaults.headers.requesttoken=e});const P=Object.assign(Ut,{CancelToken:O.CancelToken,isCancel:O.isCancel}),Dt=Symbol("csrf-retry");function Ur(e){return async t=>{if(!$e(t))throw t;const{config:n,response:r,request:s}=t,o=s?.responseURL;if(n&&!n[Dt]&&r?.status===412&&r?.data?.message==="CSRF check failed"){console.warn(`Request to ${o} failed because of a CSRF mismatch. Fetching a new token`);const{data:{token:i}}=await e.get(H("/csrftoken"));return console.debug(`New request token ${i} fetched`),e.defaults.headers.requesttoken=i,e({...n,headers:{...n.headers,requesttoken:i},[Dt]:!0})}throw t}}const ke=Symbol("retryDelay");function Dr(e){return async t=>{if(!$e(t))throw t;const{config:n,response:r,request:s}=t,o=s?.responseURL,i=r?.status,l=r?.headers;let u=typeof n?.[ke]=="number"?n?.[ke]:1;if(i===503&&l?.["x-nextcloud-maintenance-mode"]==="1"&&n?.retryIfMaintenanceMode){if(u*=2,u>32)throw console.error("Retry delay exceeded one minute, giving up.",{responseURL:o}),t;return console.warn(`Request to ${o} failed because of maintenance mode. Retrying in ${u}s`),await new Promise(c=>{setTimeout(c,u*1e3)}),e({...n,[ke]:u})}throw t}}async function Br(e){if($e(e)){const{config:t,response:n,request:r}=e,s=r?.responseURL;n?.status===401&&n?.data?.message==="Current user is not logged in"&&t?.reloadExpiredSession&&window?.location&&(console.error(`Request to ${s} failed because the user session expired. Reloading the page `),window.location.reload())}throw e}P.interceptors.response.use(e=>e,Ur(P)),P.interceptors.response.use(e=>e,Dr(P)),P.interceptors.response.use(e=>e,Br);function Mr(){const e=Jt("aiquila","config"),t=document.querySelector("#content");if(!e.has_api_key){jr(t);return}qr(t)}function jr(e){e.innerHTML=`
		<div style="display: flex; align-items: center; justify-content: center; height: 100%; padding: 40px;">
			<div style="text-align: center; max-width: 500px;">
				<h2> No API Key Configured</h2>
				<p>Please configure your Anthropic API key in the admin settings to use AIquila.</p>
				<a href="${H("/settings/admin/aiquila")}" class="button primary" style="margin-top: 20px;">
					Go to Admin Settings
				</a>
			</div>
		</div>
	`}function qr(e,t){e.innerHTML=`
		<div style="max-width: 1200px; margin: 0 auto; padding: 20px; height: 100%; display: flex; flex-direction: column;">
			<div style="margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
				<h2 style="margin: 0;">Ask Claude</h2>
				<button id="settings-toggle-btn" class="secondary" style="font-size: 14px;"> Settings</button>
			</div>

			<div id="settings-panel" style="display: none; border: 1px solid var(--color-border); border-radius: var(--border-radius); padding: 16px; margin-bottom: 20px; background: var(--color-background-dark);">
				<h3 style="margin: 0 0 12px 0; font-size: 15px;">Personal Settings</h3>

				<div style="margin-bottom: 12px;">
					<label for="settings-model" style="display: block; margin-bottom: 4px; font-size: 13px;">Model preference</label>
					<select id="settings-model" style="width: 100%; padding: 8px; border: 1px solid var(--color-border); border-radius: var(--border-radius); background: var(--color-main-background);">
						<option value="">(admin default)</option>
					</select>
				</div>

				<div style="margin-bottom: 12px;">
					<label for="settings-api-key" style="display: block; margin-bottom: 4px; font-size: 13px;">Personal API key <span style="opacity: 0.6;">(overrides admin key)</span></label>
					<div style="display: flex; gap: 8px;">
						<input type="password" id="settings-api-key" placeholder="sk-ant- (leave blank to keep current)" style="flex: 1; padding: 8px; border: 1px solid var(--color-border); border-radius: var(--border-radius); background: var(--color-main-background);">
						<button id="settings-clear-key-btn" class="secondary" style="white-space: nowrap;">Clear key</button>
					</div>
				</div>

				<div style="display: flex; justify-content: flex-end; gap: 8px; margin-top: 8px;">
					<button id="settings-cancel-btn" class="secondary">Cancel</button>
					<button id="settings-save-btn" class="primary">Save</button>
				</div>
				<p id="settings-status" style="margin: 8px 0 0 0; font-size: 13px; min-height: 18px;"></p>
			</div>

			<div id="chat-history" style="flex: 1; overflow-y: auto; border: 1px solid var(--color-border); border-radius: var(--border-radius-large); padding: 15px; background: var(--color-main-background); min-height: 400px; margin-bottom: 20px;">
				<div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--color-text-lighter);">
					<p>Start a conversation with Claude...</p>
				</div>
			</div>

			<div>
				<textarea id="prompt-input" placeholder="Ask Claude anything..." rows="3" style="width: 100%; padding: 12px; border: 1px solid var(--color-border); border-radius: var(--border-radius); font-family: var(--font-face); resize: vertical; font-size: 14px;"></textarea>
				<div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 10px;">
					<button id="clear-btn" class="secondary">Clear</button>
					<button id="ask-btn" class="primary">Ask Claude</button>
				</div>
			</div>
		</div>
	`;const n=document.getElementById("chat-history"),r=document.getElementById("prompt-input"),s=document.getElementById("ask-btn"),o=document.getElementById("clear-btn"),i=document.getElementById("settings-panel"),l=document.getElementById("settings-toggle-btn"),u=document.getElementById("settings-save-btn"),c=document.getElementById("settings-cancel-btn"),a=document.getElementById("settings-clear-key-btn"),p=document.getElementById("settings-model"),m=document.getElementById("settings-api-key"),b=document.getElementById("settings-status");l.addEventListener("click",async()=>{i.style.display==="none"?(i.style.display="block",l.textContent=" Close Settings",b.textContent="",await f()):h()}),c.addEventListener("click",()=>h()),a.addEventListener("click",()=>{m.value="",m.dataset.clear="true",m.placeholder="Key will be cleared on save"}),u.addEventListener("click",async()=>{await E()});function h(){i.style.display="none",l.textContent=" Settings",m.dataset.clear=""}async function f(){b.textContent="Loading";try{const y=H("/apps/aiquila/api/settings"),R=(await P.get(y)).data;p.innerHTML='<option value="">(admin default)</option>';for(const w of R.availableModels||[]){const T=document.createElement("option");T.value=w,T.textContent=w,w===R.userModel&&(T.selected=!0),p.appendChild(T)}m.placeholder=R.hasUserKey?"Personal key configured  enter new key to replace":"sk-ant- (leave blank to keep admin key)",m.value="",m.dataset.clear="",b.textContent=""}catch(y){b.textContent="Failed to load settings: "+y.message,b.style.color="var(--color-error)"}}async function E(){u.disabled=!0,b.textContent="Saving",b.style.color="";const y={model:p.value,api_key:m.dataset.clear==="true"?"":m.value};try{const S=H("/apps/aiquila/api/settings");await P.post(S,y),b.textContent="Saved!",b.style.color="var(--color-success)",m.value="",m.dataset.clear=""}catch(S){b.textContent="Error saving: "+S.message,b.style.color="var(--color-error)"}finally{u.disabled=!1}}s.addEventListener("click",()=>Bt(r.value,n,r,s)),o.addEventListener("click",()=>{r.value="",n.innerHTML='<div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--color-text-lighter);"><p>Start a conversation with Claude...</p></div>'}),r.addEventListener("keydown",y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),Bt(r.value,n,r,s))})}async function Bt(e,t,n,r){if(!e.trim())return;t.querySelector("p")&&(t.innerHTML=""),n.disabled=!0,r.disabled=!0,Z(t,"user",e);const s=Z(t,"assistant"," Thinking...");try{const o=H("/apps/aiquila/api/ask"),i=await P.post(o,{prompt:e,context:""});s.remove(),i.data.error?(Z(t,"error",i.data.error),console.error("Claude error:",i.data.error)):(Z(t,"assistant",i.data.response),console.log("Response received from Claude")),n.value=""}catch(o){s.remove(),Z(t,"error","Failed to communicate with Claude: "+o.message),console.error("Request failed:",o)}finally{n.disabled=!1,r.disabled=!1,n.focus()}}function Z(e,t,n){const r=document.createElement("div");r.style.cssText=`
		margin-bottom: 15px;
		padding: 12px;
		border-radius: var(--border-radius);
		${t==="user"?"background: var(--color-primary-element-light); margin-left: 20%;":""}
		${t==="assistant"?"background: var(--color-background-dark); margin-right: 20%;":""}
		${t==="error"?"background: var(--color-error); color: white;":""}
	`;const s=t==="user"?"You":t==="assistant"?"Claude":"Error";return r.innerHTML=`
		<div style="margin-bottom: 5px; font-size: 13px; opacity: 0.8;">
			<strong>${s}</strong>
		</div>
		<div style="white-space: pre-wrap; word-wrap: break-word;">
			${n}
		</div>
	`,e.appendChild(r),e.scrollTop=e.scrollHeight,r}document.addEventListener("DOMContentLoaded",()=>{Mr()})})();
